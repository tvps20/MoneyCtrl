<div class="main-content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-success card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">monetization_on</i>
                        </div>
                        <p class="card-category">Total</p>
                        <h3 class="card-title">{{ fatura.valorTotal | currency:'BRL' }}</h3>
                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            <i class="material-icons">monetization_on</i> Valores para o mês de {{ fatura.mesReferente }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-warning card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">event</i>
                        </div>
                        <p class="card-category">Vencimento</p>
                        <h3 class="card-title">{{ fatura.vencimento | date: 'dd/MM/yyyy' }}</h3>
                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            <i class="material-icons">date_range</i> Valores para o mes de {{ fatura.mesReferente }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-danger card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">event_available</i>
                        </div>
                        <p class="card-category">Referência</p>
                        <h3 class="card-title">{{ fatura.mesReferente + '/'}}{{ fatura.vencimento | date: 'yyyy' }}</h3>
                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            <i class="material-icons">calendar_today</i> Valores para o mês de {{ fatura.mesReferente }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-primary card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">help</i>
                        </div>
                        <p class="card-category">Situação</p>
                        <h3 class="card-title">{{ fatura.status }}</h3>
                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            <i class="material-icons text-danger">info</i>Aceita novos lançamentos
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-info card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">info</i>
                        </div>
                        <p class="card-category">Observação</p>
                        <h3 class="card-title">Nenhuma</h3>
                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            <i class="material-icons text-primary">more_horiz</i>
                            <a href="javascript:void(0)">Detalhes</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-secondary card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">receipt</i>
                        </div>
                        <p class="card-category">Lançamentos</p>
                        <h3 class="card-title">{{ fatura.lancamentos.length }}</h3>
                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            <i class="material-icons">update</i> Atualizado
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header card-header-tabs card-header-info">
                        <div class="nav-tabs-navigation">
                            <div class="nav-tabs-wrapper">
                                <ul class="nav nav-tabs" data-tabs="tabs">
                                    <li class="nav-item">
                                        <a mat-button class="nav-link active" href="#cotas" data-toggle="tab">
                                            <i class="material-icons">pie_chart</i> Cotas
                                            <div class="ripple-container"></div>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a mat-button class="nav-link" href="#lancamentos" data-toggle="tab">
                                            <i class="material-icons">shop_two</i> Lançamentos
                                            <div class="ripple-container"></div>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a mat-button class="nav-link" href="#adicionar" data-toggle="tab">
                                            <i class="material-icons">library_add</i> Adicionar
                                            <div class="ripple-container"></div>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="tab-content">
                            <div class="tab-pane active" id="cotas">
                                <div class="row" *ngIf="fatura.lancamentos.length > 0; else loadingListEmptyCotas">
                                    <div [class]="cotas.length > 1 ? 'col-lg-6 col-md-6 col-sm-12' : 'col-lg-6 col-md-12 col-sm-12'"
                                        *ngFor="let cotaFatura of cotas">
                                        <div class="card">
                                            <div class="card-header card-header-primary">
                                                <div class="row">
                                                    <div class="col-md-8">
                                                        <h5 class="card-title">{{ cotaFatura.compradorNome }}</h5>
                                                    </div>
                                                    <div class="col-md-4 text-right">
                                                        <p class="card-category">Total: {{ cotaFatura.valorTotal | currency:'BRL' }}</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body table-responsive">
                                                <table class="table table-hover">
                                                    <thead class="text-primary">
                                                        <th>Descrição</th>
                                                        <th>valor</th>
                                                        <th>Parcela</th>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let cota of cotaFatura.cotas" >
                                                            <td>{{ cota.lancamento.descricao }}</td>
                                                            <td>{{ cota.valor | currency:'BRL' }}</td>
                                                            <td>{{ cota.lancamento.parcelado ? (cota.lancamento.parcelaAtual + '/' + cota.lancamento.qtdParcelas) : '-'}}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <ng-template #loadingListEmptyCotas>
                                    <p class="text-muted text-center">Nenhuma cota disponivel para essa fatura.</p>
                                </ng-template>
                            </div>
                            <div class="tab-pane" id="lancamentos">
                                <div class="table-responsive">
                                    <table class="table table-hover"
                                    *ngIf="fatura.lancamentos.length > 0; else loadingListEmptyLancamentos">
                                        <thead class=" text-primary">
                                            <th>Descrição</th>
                                            <th>Data da Compra</th>
                                            <th>Valor</th>
                                            <th>Parcela</th>
                                            <th>Cotas</th>
                                            <th>Ação</th>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let lancamento of fatura.lancamentos">
                                                <td>{{ lancamento.descricao }}</td>
                                                <td>{{ lancamento.dataCompra | date: 'dd/MM/yyyy' }}</td>
                                                <td>{{ lancamento.valorTotal | currency:'BRL' }}</td>
                                                <td>{{ lancamento.parcelado ? (lancamento.parcelaAtual + '/' + lancamento.qtdParcelas) : '-'}}</td>
                                                <td>{{ lancamento.cotas.length }}</td>
                                                <td class="text-primary">
                                                    <button mat-raised-button type="button"
                                                        matTooltip="Detalhes" matTooltipPosition="above"
                                                        data-toggle="modal" data-target="#detalhesModalLancamento"
                                                        class="btn btn-primary btn-link btn-sm btn-just-icon">
                                                        <i class="material-icons">description</i>
                                                    </button>
                                                    <button mat-raised-button type="button"
                                                        matTooltip="Editar" matTooltipPosition="above"
                                                        class="btn btn-primary btn-link btn-sm btn-just-icon">
                                                        <i class="material-icons">edit</i>
                                                    </button>
                                                    <button mat-raised-button type="button"
                                                        matTooltip="Excluir" matTooltipPosition="above"
                                                        class="btn btn-danger btn-link btn-sm btn-just-icon">
                                                        <i class="material-icons">close</i>
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <ng-template #loadingListEmptyLancamentos>
                                        <p class="text-muted text-center">Nenhum lançamento disponivel para essa fatura.</p>
                                    </ng-template>
                                </div>
                            </div>
                            <div class="tab-pane" id="adicionar">
                                <div class="card-body">
                                    <form>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <mat-accordion class="example-headers-align">
                                                    <mat-expansion-panel [expanded]="step === 0" (opened)="setStep(0)"
                                                        hideToggle>
                                                        <mat-expansion-panel-header>
                                                            <mat-panel-title>
                                                                Dados do lançamento
                                                            </mat-panel-title>
                                                            <mat-panel-description>
                                                                Data da compra, valor, compradores...
                                                            </mat-panel-description>
                                                        </mat-expansion-panel-header>

                                                        <div class="row">
                                                            <div class="col-md-8">
                                                                <mat-form-field appearance="outline"
                                                                    class="example-full-width">
                                                                    <mat-label>Descrição</mat-label>
                                                                    <input matInput
                                                                        placeholder="Breve descrição da compra...">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="col-md-2">
                                                                <p>
                                                                    <mat-checkbox [formControl]="disableSelect">
                                                                        Parcelado</mat-checkbox>
                                                                </p>
                                                            </div>
                                                            <div class="col-md-2">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Parcelas</mat-label>
                                                                    <input matInput [disabled]="disableSelect.value"
                                                                         value="01/10">
                                                                </mat-form-field>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-4">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Data da Compra</mat-label>
                                                                    <input matInput [matDatepicker]="dp3" disabled>
                                                                    <mat-datepicker-toggle matSuffix [for]="dp3">
                                                                    </mat-datepicker-toggle>
                                                                    <mat-datepicker #dp3 disabled="false">
                                                                    </mat-datepicker>
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="col-md-4">
                                                                <mat-form-field>
                                                                    <mat-label>Comprador</mat-label>
                                                                    <mat-select>
                                                                        <mat-option *ngFor="let comprador of compradorSelect$ | async" value="comprador.id">{{ comprador.nome }}</mat-option>
                                                                    </mat-select>
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="col-md-2">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Valor</mat-label>
                                                                    <input matInput
                                                                        value="R$ 00,00">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="col-md-2">
                                                                <button type="button" mat-button class="nav-link">
                                                                    <i class="material-icons">library_add</i> Adicionar
                                                                    <div class="ripple-container"></div>
                                                                </button>
                                                            </div>
                                                        </div>

                                                        <mat-action-row>
                                                            <button mat-button color="primary"
                                                                (click)="nextStep()">Next</button>
                                                        </mat-action-row>
                                                    </mat-expansion-panel>

                                                    <mat-expansion-panel [expanded]="step === 1" (opened)="setStep(1)"
                                                        hideToggle>
                                                        <mat-expansion-panel-header>
                                                            <mat-panel-title>
                                                                Compradores: 2
                                                            </mat-panel-title>
                                                            <mat-panel-description>
                                                                Total: 47,44 R$
                                                            </mat-panel-description>
                                                        </mat-expansion-panel-header>

                                                        <div class="row">
                                                            <div class="card-body">
                                                                <div class="table-responsive">
                                                                    <table class="table table-hover">
                                                                        <thead class=" text-primary">
                                                                            <th>Comprador</th>
                                                                            <th>Valor</th>
                                                                            <th>Ação</th>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr>
                                                                                <td>Thiago</td>
                                                                                <td>R$ 18,89</td>
                                                                                <td class="text-primary">
                                                                                    <button mat-raised-button
                                                                                        type="button"
                                                                                        class="btn btn-danger btn-link btn-sm btn-just-icon">
                                                                                        <i
                                                                                            class="material-icons">close</i>
                                                                                    </button>
                                                                                </td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td>Gilson</td>
                                                                                <td>R$ 28,55</td>
                                                                                <td class="text-primary">
                                                                                    <button mat-raised-button
                                                                                        type="button"
                                                                                        class="btn btn-danger btn-link btn-sm btn-just-icon">
                                                                                        <i
                                                                                            class="material-icons">close</i>
                                                                                    </button>
                                                                                </td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <mat-action-row>
                                                            <button mat-button color="warn"
                                                                (click)="prevStep()">Previous</button>
                                                            <button mat-button color="primary"
                                                                (click)="nextStep()">Next</button>
                                                        </mat-action-row>
                                                    </mat-expansion-panel>

                                                    <mat-expansion-panel [expanded]="step === 2" (opened)="setStep(2)"
                                                        hideToggle>
                                                        <mat-expansion-panel-header>
                                                            <mat-panel-title>
                                                                Observação
                                                            </mat-panel-title>
                                                            <mat-panel-description>
                                                                Alguma informação relevante...
                                                            </mat-panel-description>
                                                        </mat-expansion-panel-header>

                                                        <div class="row">
                                                            <div class="col-md-12">
                                                                <mat-form-field appearance="outline"
                                                                    class="example-full-width">
                                                                    <mat-label>Lembrou de algo? Deixa aqui para não
                                                                        esquecer...</mat-label>
                                                                    <textarea matInput
                                                                        placeholder="Observação"></textarea>
                                                                </mat-form-field>
                                                            </div>
                                                        </div>

                                                        <mat-action-row>
                                                            <button mat-button color="warn"
                                                                (click)="prevStep()">Previous</button>
                                                            <button mat-button color="primary"
                                                                (click)="nextStep()">End</button>
                                                        </mat-action-row>
                                                    </mat-expansion-panel>

                                                </mat-accordion>
                                            </div>
                                        </div>
                                        <br />
                                        <button mat-raised-button appearance="outline" type="submit"
                                            class="btn btn-info pull-right">Salvar</button>
                                        <div class="clearfix"></div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal de detalhes do lançamento -->
<app-modal-lancamento></app-modal-lancamento>
